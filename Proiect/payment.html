<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeGa Payment</title>
    <link rel="stylesheet" href="css/payment.css">
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="icon" href="images/flower_icon_bar.png">
</head>

<body>
    <div id="navbar"></div>

    <div class="payment-container">
        <h2>Payment Details</h2>
        <form id="payment-form">
            <div class="form-group">
                <label for="fname">First Name</label>
                <input type="text" id="fname" name="firstname" placeholder="Your first name..">
            </div>

            <div class="form-group">
                <label for="lname">Last Name</label>
                <input type="text" id="lname" name="lastname" placeholder="Your last name..">
            </div>

            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="Your email..">
            </div>

            <div class="form-group">
                <label for="address">Address</label>
                <input type="text" id="address" name="address" placeholder="Your address..">
            </div>

            <div class="form-group">
                <label for="city">City</label>
                <input type="text" id="city" name="city" placeholder="Your city..">
            </div>

            <div class="form-group">
                <label for="state">State</label>
                <input type="text" id="state" name="state" placeholder="Your state..">
            </div>

            <div class="form-group">
                <label for="zip">Zip Code</label>
                <input type="text" id="zip" name="zip" placeholder="Your zip code..">
            </div>

            <div class="form-group">
                <label for="ccnum">Credit Card Number</label>
                <input type="text" id="ccnum" name="cardnumber" placeholder="Your credit card number..">
            </div>

            <div class="form-group">
                <label for="expmonth">Exp Month</label>
                <input type="text" id="expmonth" name="expmonth" placeholder="MM">
            </div>

            <div class="form-group">
                <label for="expyear">Exp Year</label>
                <input type="text" id="expyear" name="expyear" placeholder="YYYY">
            </div>

            <div class="form-group">
                <label for="cvv">CVV</label>
                <input type="text" id="cvv" name="cvv" placeholder="Your CVV..">
            </div>

            <input type="submit" value="Submit">
        </form>
    </div>

    <div id="footer"></div>

    <script src = "js/navbar_and_footer.js"> </script>
    <script>
document.getElementById('payment-form').addEventListener('submit', function(event) {
    event.preventDefault();

    // Get the token from localStorage
    const token = localStorage.getItem('jwtToken');

    // Basic credit card validation
    var ccNum = document.getElementById('ccnum').value;
    if(ccNum.length != 16) {
        alert('Please enter a valid 16-digit credit card number');
        return;
    }

    const formData = {
        token, // Include the token in the formData sent to the server
        firstName: document.getElementById('fname').value,
        lastName: document.getElementById('lname').value,
        email: document.getElementById('email').value,
        address: document.getElementById('address').value,
        city: document.getElementById('city').value,
        state: document.getElementById('state').value,
        zip: document.getElementById('zip').value,
        cardNumber: ccNum,
        expMonth: document.getElementById('expmonth').value,
        expYear: document.getElementById('expyear').value,
        cvv: document.getElementById('cvv').value
    };

    fetch('/submit-payment', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(formData)
    }).then(response => response.json())
      .then(data => {
          if(data.success) {
              alert('Order submitted successfully!');
              window.location.href = 'shop.html'; // Redirect to the shop page
          } else {
              alert('Failed to submit order: ' + data.message);
          }
      });
});



        </script>
        
</body>

</html>
